# Story 2.3 - View and Edit Financial Information Implementation Plan

## Overview

Implement a dedicated Profile page (`/profile`) where users can view and edit their financial information after completing onboarding. Changes trigger projection recomputation, and the UI provides clear feedback through toast notifications.

## Current State Analysis

### What Exists
- **Step5Review component** ([step5-review.tsx](src/components/onboarding/step5-review.tsx)) - Implements the exact modal-based editing pattern we need
- **All step components** - Accept `initialData` prop and can be reused in edit dialogs
- **Validation schema** - `profileUpdateSchema` exists at [profile.ts](src/lib/validation/profile.ts) with `.partial()` for optional fields
- **Database schema** - All financial fields in `financial_snapshot` table ([financial-snapshot.ts](src/db/schema/financial-snapshot.ts))
- **Toast components** - Built but not mounted in layout ([toast.tsx](src/components/ui/toast.tsx), [toaster.tsx](src/components/ui/toaster.tsx), [use-toast.ts](src/hooks/use-toast.ts))

### What's Missing
- `/profile` route and page
- Profile navigation link
- `PATCH /api/profile` endpoint
- Toaster mounted in layout

## Desired End State

After implementation:
1. Users see "Profile" link in desktop navigation (between "Plans" and theme toggle)
2. Clicking Profile opens `/profile` page showing all financial inputs in collapsible sections
3. Each section has an "Edit" button that opens a modal with the original step form
4. Saving updates persists to database and shows success toast
5. Projection automatically recomputes with updated data when user visits `/plans`

### Verification
- Navigate to `/profile` → See all financial data organized in sections
- Click "Edit" on any section → Modal opens with pre-filled form
- Submit valid changes → Toast shows "Profile updated successfully"
- Navigate to `/plans` → Projections reflect updated data

## What We're NOT Doing

- Mobile navigation menu (Profile desktop-only, matching existing pattern)
- Unsaved changes confirmation dialog (Cancel just closes modal)
- Dirty state indicators in UI (future enhancement)
- What-if scenario exploration (separate future feature)
- Projection results on profile page (inputs only)

## Implementation Approach

Reuse the Step5Review modal pattern extensively. The profile page will be a simplified version that:
1. Fetches financial snapshot server-side
2. Renders client component with collapsible sections
3. Opens step components in dialogs for editing
4. Calls PATCH API to persist changes
5. Shows toast notification on success/failure

---

## Phase 1: Foundation (Toast + Navigation)

### Overview
Mount the Toaster component and add Profile navigation link.

### Changes Required

#### 1. Mount Toaster in Layout
**File**: `src/app/layout.tsx`

Add Toaster import and component:

```tsx
import { Toaster } from '@/components/ui/toaster';
```

Add `<Toaster />` inside ThemeProvider, after `<main>`:

```tsx
<ThemeProvider ...>
  <SkipToContent />
  <Navigation />
  <main id="main-content">{children}</main>
  <Toaster />
</ThemeProvider>
```

#### 2. Add Profile Navigation Link
**File**: `src/components/layout/navigation.tsx`

Update navItems array at line 8-11:

```tsx
const navItems = [
  { href: '/dashboard', label: 'Dashboard' },
  { href: '/plans', label: 'Plans' },
  { href: '/profile', label: 'Profile' },
];
```

### Success Criteria

#### Automated Verification:
- [x] TypeScript compiles: `npm run typecheck`
- [x] Linting passes: `npm run lint`
- [x] Build succeeds: `npm run build`

#### Manual Verification:
- [ ] Toaster renders (can test by calling `toast()` from any component)
- [ ] "Profile" link appears in desktop navigation
- [ ] Clicking Profile link navigates to `/profile` (will 404 until Phase 2)

---

## Phase 2: Profile Page Server Component

### Overview
Create the `/profile` route with server-side data fetching.

### Changes Required

#### 1. Create Profile Page
**File**: `src/app/profile/page.tsx`

```tsx
import { redirect } from 'next/navigation';
import { getServerUser } from '@/lib/auth/server';
import { db } from '@/db/client';
import { financialSnapshot } from '@/db/schema';
import { eq } from 'drizzle-orm';
import { ProfileClient } from './profile-client';

export default async function ProfilePage() {
  const user = await getServerUser();

  if (!user) {
    redirect('/auth/login');
  }

  const snapshot = await db.query.financialSnapshot.findFirst({
    where: eq(financialSnapshot.userId, user.id),
  });

  if (!snapshot) {
    redirect('/onboarding');
  }

  // Transform DB types to client-safe format
  const profileData = {
    birthYear: snapshot.birthYear,
    targetRetirementAge: snapshot.targetRetirementAge,
    filingStatus: snapshot.filingStatus,
    annualIncome: Number(snapshot.annualIncome),
    savingsRate: Number(snapshot.savingsRate),
    riskTolerance: snapshot.riskTolerance,
    investmentAccounts: snapshot.investmentAccounts ?? [],
    primaryResidence: snapshot.primaryResidence ?? null,
    debts: snapshot.debts ?? [],
    incomeExpenses: snapshot.incomeExpenses ?? null,
  };

  return (
    <div className="mx-auto max-w-4xl px-4 py-8 sm:px-6 lg:px-8">
      <h1 className="text-2xl font-bold text-foreground mb-6">
        Financial Profile
      </h1>
      <p className="text-muted-foreground mb-8">
        Review and update your financial information. Changes will be reflected in your retirement projections.
      </p>
      <ProfileClient initialData={profileData} />
    </div>
  );
}
```

#### 2. Create ProfileClient Placeholder
**File**: `src/app/profile/profile-client.tsx`

```tsx
'use client';

import type { CompleteOnboardingDataV2 } from '@/types/onboarding';

interface ProfileClientProps {
  initialData: Partial<CompleteOnboardingDataV2>;
}

export function ProfileClient({ initialData }: ProfileClientProps) {
  return (
    <div className="space-y-4">
      <p className="text-muted-foreground">
        Profile data loaded. UI coming in Phase 3.
      </p>
      <pre className="text-xs bg-muted p-4 rounded overflow-auto">
        {JSON.stringify(initialData, null, 2)}
      </pre>
    </div>
  );
}
```

### Success Criteria

#### Automated Verification:
- [x] TypeScript compiles: `npm run typecheck`
- [x] Build succeeds: `npm run build`

#### Manual Verification:
- [ ] Navigate to `/profile` while logged in → See page with JSON data
- [ ] Navigate to `/profile` while logged out → Redirect to `/auth/login`
- [ ] Navigate to `/profile` without onboarding → Redirect to `/onboarding`

---

## Phase 3: Profile Page UI (Collapsible Sections)

### Overview
Implement the full ProfileClient with collapsible sections and edit buttons, reusing Step5Review display patterns.

### Changes Required

#### 1. Complete ProfileClient Implementation
**File**: `src/app/profile/profile-client.tsx`

```tsx
'use client';

import { useState } from 'react';
import { Collapsible } from '@/components/ui/collapsible';
import { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';
import { Step1PersonalInfo } from '@/components/onboarding/step1-personal-info';
import { Step2RetirementInfo } from '@/components/onboarding/step2-retirement-info';
import { Step3FinancialInfo } from '@/components/onboarding/step3-financial-info';
import { Step4RiskTolerance } from '@/components/onboarding/step4-risk-tolerance';
import { Step2bSavingsContributions } from '@/components/onboarding/step2b-savings-contributions';
import { Step3bIncomeExpenses } from '@/components/onboarding/step3b-income-expenses';
import { Step4bAssetsDebts } from '@/components/onboarding/step4b-assets-debts';
import { useToast } from '@/hooks/use-toast';
import type { CompleteOnboardingDataV2 } from '@/types/onboarding';

type EditSection =
  | 'basics'
  | 'retirement'
  | 'income'
  | 'risk'
  | 'savings'
  | 'expenses'
  | 'assets'
  | null;

interface ProfileClientProps {
  initialData: Partial<CompleteOnboardingDataV2>;
}

export function ProfileClient({ initialData }: ProfileClientProps) {
  const [profileData, setProfileData] = useState(initialData);
  const [editSection, setEditSection] = useState<EditSection>(null);
  const [isSaving, setIsSaving] = useState(false);
  const { toast } = useToast();

  const handleEditClose = () => setEditSection(null);

  const handleEditSave = async (data: Partial<CompleteOnboardingDataV2>) => {
    setIsSaving(true);
    try {
      const response = await fetch('/api/profile', {
        method: 'PATCH',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
      });

      if (!response.ok) {
        const error = await response.json();
        throw new Error(error.message || 'Failed to update profile');
      }

      // Merge updated data into local state
      setProfileData((prev) => ({ ...prev, ...data }));
      setEditSection(null);
      toast({
        title: 'Profile updated',
        description: 'Your financial information has been saved.',
      });
    } catch (error) {
      toast({
        title: 'Update failed',
        description: error instanceof Error ? error.message : 'Please try again.',
        variant: 'destructive',
      });
    } finally {
      setIsSaving(false);
    }
  };

  // Format helpers
  const formatCurrency = (value: number | undefined) =>
    value !== undefined
      ? new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(value)
      : '—';

  const formatPercent = (value: number | undefined) =>
    value !== undefined ? `${value}%` : '—';

  const currentYear = new Date().getFullYear();
  const currentAge = profileData.birthYear ? currentYear - profileData.birthYear : undefined;
  const yearsToRetirement = profileData.targetRetirementAge && currentAge
    ? profileData.targetRetirementAge - currentAge
    : undefined;

  return (
    <div className="space-y-4">
      {/* Basics Section */}
      <Collapsible
        title="Basics"
        defaultOpen
        onEdit={() => setEditSection('basics')}
      >
        <div className="grid grid-cols-2 gap-4 text-sm">
          <div>
            <span className="text-muted-foreground">Birth Year:</span>
            <span className="ml-2 font-medium">{profileData.birthYear}</span>
          </div>
          <div>
            <span className="text-muted-foreground">Current Age:</span>
            <span className="ml-2 font-medium">{currentAge}</span>
          </div>
        </div>
      </Collapsible>

      {/* Retirement Goals Section */}
      <Collapsible
        title="Retirement Goals"
        defaultOpen
        onEdit={() => setEditSection('retirement')}
      >
        <div className="grid grid-cols-2 gap-4 text-sm">
          <div>
            <span className="text-muted-foreground">Target Retirement Age:</span>
            <span className="ml-2 font-medium">{profileData.targetRetirementAge}</span>
          </div>
          <div>
            <span className="text-muted-foreground">Years to Retirement:</span>
            <span className="ml-2 font-medium">{yearsToRetirement}</span>
          </div>
          <div>
            <span className="text-muted-foreground">Filing Status:</span>
            <span className="ml-2 font-medium capitalize">
              {profileData.filingStatus?.replace('_', ' ')}
            </span>
          </div>
        </div>
      </Collapsible>

      {/* Income & Savings Section */}
      <Collapsible
        title="Income & Savings"
        defaultOpen
        onEdit={() => setEditSection('income')}
      >
        <div className="grid grid-cols-2 gap-4 text-sm">
          <div>
            <span className="text-muted-foreground">Annual Income:</span>
            <span className="ml-2 font-medium">{formatCurrency(profileData.annualIncome)}</span>
          </div>
          <div>
            <span className="text-muted-foreground">Savings Rate:</span>
            <span className="ml-2 font-medium">{formatPercent(profileData.savingsRate)}</span>
          </div>
        </div>
      </Collapsible>

      {/* Risk Tolerance Section */}
      <Collapsible
        title="Risk Tolerance"
        defaultOpen
        onEdit={() => setEditSection('risk')}
      >
        <div className="text-sm">
          <span className="text-muted-foreground">Risk Level:</span>
          <span className="ml-2 font-medium capitalize">{profileData.riskTolerance}</span>
        </div>
      </Collapsible>

      {/* Investment Accounts Section */}
      <Collapsible
        title="Investment Accounts"
        defaultOpen
        onEdit={() => setEditSection('savings')}
      >
        {profileData.investmentAccounts && profileData.investmentAccounts.length > 0 ? (
          <div className="space-y-3">
            {profileData.investmentAccounts.map((account) => (
              <div key={account.id} className="flex justify-between text-sm border-b pb-2 last:border-0">
                <div>
                  <span className="font-medium">{account.label || account.type}</span>
                  <span className="text-muted-foreground ml-2">({account.type.replace('_', ' ')})</span>
                </div>
                <div className="text-right">
                  <div>{formatCurrency(account.balance)}</div>
                  {account.monthlyContribution && account.monthlyContribution > 0 && (
                    <div className="text-muted-foreground text-xs">
                      +{formatCurrency(account.monthlyContribution)}/mo
                    </div>
                  )}
                </div>
              </div>
            ))}
          </div>
        ) : (
          <p className="text-sm text-muted-foreground">No investment accounts added.</p>
        )}
      </Collapsible>

      {/* Monthly Expenses Section */}
      <Collapsible
        title="Monthly Expenses"
        defaultOpen
        onEdit={() => setEditSection('expenses')}
      >
        <div className="grid grid-cols-2 gap-4 text-sm">
          <div>
            <span className="text-muted-foreground">Essential:</span>
            <span className="ml-2 font-medium">
              {formatCurrency(profileData.incomeExpenses?.monthlyEssential)}
            </span>
          </div>
          <div>
            <span className="text-muted-foreground">Discretionary:</span>
            <span className="ml-2 font-medium">
              {formatCurrency(profileData.incomeExpenses?.monthlyDiscretionary)}
            </span>
          </div>
        </div>
      </Collapsible>

      {/* Assets & Debts Section */}
      <Collapsible
        title="Assets & Debts"
        defaultOpen
        onEdit={() => setEditSection('assets')}
      >
        <div className="space-y-4 text-sm">
          {profileData.primaryResidence?.estimatedValue && (
            <div>
              <h4 className="font-medium mb-2">Primary Residence</h4>
              <div className="grid grid-cols-2 gap-2 pl-4">
                <div>
                  <span className="text-muted-foreground">Value:</span>
                  <span className="ml-2">{formatCurrency(profileData.primaryResidence.estimatedValue)}</span>
                </div>
                {profileData.primaryResidence.mortgageBalance && (
                  <div>
                    <span className="text-muted-foreground">Mortgage:</span>
                    <span className="ml-2">{formatCurrency(profileData.primaryResidence.mortgageBalance)}</span>
                  </div>
                )}
              </div>
            </div>
          )}
          {profileData.debts && profileData.debts.length > 0 && (
            <div>
              <h4 className="font-medium mb-2">Debts</h4>
              {profileData.debts.map((debt) => (
                <div key={debt.id} className="flex justify-between pl-4 border-b pb-2 last:border-0">
                  <span>{debt.label || debt.type}</span>
                  <span>{formatCurrency(debt.balance)}</span>
                </div>
              ))}
            </div>
          )}
          {!profileData.primaryResidence?.estimatedValue && (!profileData.debts || profileData.debts.length === 0) && (
            <p className="text-muted-foreground">No assets or debts added.</p>
          )}
        </div>
      </Collapsible>

      {/* Edit Dialogs */}
      <Dialog open={editSection === 'basics'} onOpenChange={handleEditClose}>
        <DialogContent className="max-w-lg">
          <DialogHeader>
            <DialogTitle>Edit Basic Information</DialogTitle>
          </DialogHeader>
          <Step1PersonalInfo
            onNext={(data) => handleEditSave(data)}
            initialData={profileData}
          />
        </DialogContent>
      </Dialog>

      <Dialog open={editSection === 'retirement'} onOpenChange={handleEditClose}>
        <DialogContent className="max-w-lg">
          <DialogHeader>
            <DialogTitle>Edit Retirement Goals</DialogTitle>
          </DialogHeader>
          <Step2RetirementInfo
            onNext={(data) => handleEditSave(data)}
            onBack={handleEditClose}
            initialData={profileData}
          />
        </DialogContent>
      </Dialog>

      <Dialog open={editSection === 'income'} onOpenChange={handleEditClose}>
        <DialogContent className="max-w-lg">
          <DialogHeader>
            <DialogTitle>Edit Income & Savings</DialogTitle>
          </DialogHeader>
          <Step3FinancialInfo
            onNext={(data) => handleEditSave(data)}
            onBack={handleEditClose}
            initialData={profileData}
          />
        </DialogContent>
      </Dialog>

      <Dialog open={editSection === 'risk'} onOpenChange={handleEditClose}>
        <DialogContent className="max-w-lg">
          <DialogHeader>
            <DialogTitle>Edit Risk Tolerance</DialogTitle>
          </DialogHeader>
          <Step4RiskTolerance
            onNext={(data) => handleEditSave(data)}
            onBack={handleEditClose}
            initialData={profileData}
          />
        </DialogContent>
      </Dialog>

      <Dialog open={editSection === 'savings'} onOpenChange={handleEditClose}>
        <DialogContent className="max-w-2xl">
          <DialogHeader>
            <DialogTitle>Edit Investment Accounts</DialogTitle>
          </DialogHeader>
          <Step2bSavingsContributions
            onNext={(data) => handleEditSave(data)}
            onBack={handleEditClose}
            initialData={profileData}
          />
        </DialogContent>
      </Dialog>

      <Dialog open={editSection === 'expenses'} onOpenChange={handleEditClose}>
        <DialogContent className="max-w-lg">
          <DialogHeader>
            <DialogTitle>Edit Monthly Expenses</DialogTitle>
          </DialogHeader>
          <Step3bIncomeExpenses
            onNext={(data) => handleEditSave(data)}
            onBack={handleEditClose}
            initialData={profileData}
          />
        </DialogContent>
      </Dialog>

      <Dialog open={editSection === 'assets'} onOpenChange={handleEditClose}>
        <DialogContent className="max-w-2xl">
          <DialogHeader>
            <DialogTitle>Edit Assets & Debts</DialogTitle>
          </DialogHeader>
          <Step4bAssetsDebts
            onNext={(data) => handleEditSave(data)}
            onBack={handleEditClose}
            initialData={profileData}
          />
        </DialogContent>
      </Dialog>
    </div>
  );
}
```

### Success Criteria

#### Automated Verification:
- [x] TypeScript compiles: `npm run typecheck`
- [x] Build succeeds: `npm run build`

#### Manual Verification:
- [ ] All 7 collapsible sections render with correct data
- [ ] Each section shows "Edit" button
- [ ] Clicking Edit opens appropriate modal with pre-filled form
- [ ] Cancel/close button closes modal
- [ ] API calls will fail (expected - Phase 4 creates endpoint)

---

## Phase 4: PATCH API Endpoint

### Overview
Create the API endpoint to persist profile updates to the database.

### Changes Required

#### 1. Create Profile API Route
**File**: `src/app/api/profile/route.ts`

```tsx
import { NextRequest, NextResponse } from 'next/server';
import { getServerUser } from '@/lib/auth/server';
import { db } from '@/db/client';
import { financialSnapshot } from '@/db/schema';
import { profileUpdateSchema } from '@/lib/validation/profile';
import { eq } from 'drizzle-orm';

export async function PATCH(request: NextRequest) {
  try {
    // Verify authentication
    const user = await getServerUser();
    if (!user) {
      return NextResponse.json({ message: 'Unauthorized' }, { status: 401 });
    }

    // Validate request body
    const body = await request.json();
    const parseResult = profileUpdateSchema.safeParse(body);

    if (!parseResult.success) {
      return NextResponse.json(
        { message: 'Invalid data', errors: parseResult.error.flatten() },
        { status: 400 }
      );
    }

    const data = parseResult.data;

    // Build update object with only provided fields
    const updateData: Record<string, unknown> = {
      updatedAt: new Date(),
    };

    // Scalar fields
    if (data.birthYear !== undefined) {
      updateData.birthYear = data.birthYear;
    }
    if (data.targetRetirementAge !== undefined) {
      updateData.targetRetirementAge = data.targetRetirementAge;
    }
    if (data.filingStatus !== undefined) {
      updateData.filingStatus = data.filingStatus;
    }
    if (data.annualIncome !== undefined) {
      updateData.annualIncome = data.annualIncome.toString();
    }
    if (data.savingsRate !== undefined) {
      updateData.savingsRate = data.savingsRate.toString();
    }
    if (data.riskTolerance !== undefined) {
      updateData.riskTolerance = data.riskTolerance;
    }

    // JSONB fields
    if (data.investmentAccounts !== undefined) {
      updateData.investmentAccounts = data.investmentAccounts;
    }
    if (data.primaryResidence !== undefined) {
      updateData.primaryResidence = data.primaryResidence;
    }
    if (data.debts !== undefined) {
      updateData.debts = data.debts;
    }
    if (data.incomeExpenses !== undefined) {
      updateData.incomeExpenses = data.incomeExpenses;
    }

    // Update database
    const result = await db
      .update(financialSnapshot)
      .set(updateData)
      .where(eq(financialSnapshot.userId, user.id))
      .returning();

    if (result.length === 0) {
      return NextResponse.json(
        { message: 'Profile not found. Please complete onboarding.' },
        { status: 404 }
      );
    }

    return NextResponse.json({
      message: 'Profile updated successfully',
    });
  } catch (error) {
    console.error('Profile update error:', error);
    return NextResponse.json(
      { message: 'Failed to update profile' },
      { status: 500 }
    );
  }
}
```

### Success Criteria

#### Automated Verification:
- [ ] TypeScript compiles: `npm run typecheck`
- [ ] Build succeeds: `npm run build`

#### Manual Verification:
- [ ] Edit a section and save → Toast shows "Profile updated"
- [ ] Refresh page → Changes are persisted
- [ ] Navigate to `/plans` → Projections use updated data
- [ ] Submit invalid data → Toast shows error message
- [ ] API returns 401 when not authenticated

---

## Phase 5: Integration Testing & Polish

### Overview
Verify end-to-end flow works correctly and add any final polish.

### Testing Checklist

#### Display Verification:
- [ ] Profile page shows all financial data from onboarding
- [ ] Values match what was entered during onboarding
- [ ] Calculated fields (current age, years to retirement) are accurate
- [ ] Empty states show appropriate messages

#### Edit Flow Verification:
- [ ] Each edit button opens correct modal
- [ ] Forms are pre-filled with current data
- [ ] Validation works (try invalid values)
- [ ] Cancel closes modal without saving
- [ ] Save updates local state immediately
- [ ] Toast notifications appear correctly

#### Persistence Verification:
- [ ] Saved changes persist after page refresh
- [ ] Changes reflect in `/plans` projections
- [ ] Database `updated_at` timestamp updates

#### Edge Cases:
- [ ] Edit multiple sections in sequence
- [ ] Save with no changes (should still succeed)
- [ ] Network error during save (toast shows error)

### Success Criteria

#### Automated Verification:
- [ ] Full build succeeds: `npm run build`
- [ ] All existing tests pass: `npm test`

#### Manual Verification:
- [ ] Complete walkthrough of all acceptance criteria from Story 2.3
- [ ] All edge cases tested

---

## Testing Strategy

### Unit Tests (Future Enhancement)
- `ProfileClient` component rendering
- `PATCH /api/profile` endpoint with various inputs
- Validation schema edge cases

### Integration Tests (Future Enhancement)
- End-to-end profile edit flow
- Auth redirect behavior
- Projection recompute after profile update

### Manual Testing Steps
1. Complete onboarding with sample data
2. Navigate to `/profile` from navigation
3. Verify all sections display correct data
4. Edit each section one by one, saving changes
5. Refresh page and verify persistence
6. Navigate to `/plans` and verify projection updated

---

## File Summary

### New Files
| File | Purpose |
|------|---------|
| `src/app/profile/page.tsx` | Server component - auth, data fetch, layout |
| `src/app/profile/profile-client.tsx` | Client component - UI, modals, API calls |
| `src/app/api/profile/route.ts` | PATCH endpoint for profile updates |

### Modified Files
| File | Change |
|------|--------|
| `src/app/layout.tsx` | Add Toaster component |
| `src/components/layout/navigation.tsx` | Add Profile nav link |

### Reused Components (No Changes Needed)
- All step components (`Step1PersonalInfo`, etc.)
- `Collapsible` component
- `Dialog` components
- `useToast` hook
- `profileUpdateSchema` validation

---

## References

- **Story Scope**: [story-3-scope.md](thoughts/personal/tickets/epic-2/onboarding/story-3-scope.md)
- **Research Document**: [2025-12-25-story-2.3-view-edit-financial-info-research.md](thoughts/shared/research/2025-12-25-story-2.3-view-edit-financial-info-research.md)
- **Step5Review Pattern**: [step5-review.tsx](src/components/onboarding/step5-review.tsx)
- **Validation Schema**: [profile.ts](src/lib/validation/profile.ts)
- **DB Schema**: [financial-snapshot.ts](src/db/schema/financial-snapshot.ts)
